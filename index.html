<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epitome</title>
    
    <link rel="stylesheet" type="text/css" href="http://documentup.com/stylesheets/screen.css">
    
    

    
  </head>
  <body><div id="container">
  <div id="nav">
    
      <div id="header">
        <a href="#" id="logo">Epitome</a>
      </div>
    
    <ul id="sections">
      
        <li>
          <a href="#epitome-model-api">Epitome.Model - API</a>
          
            <ul>
              
                <li>
                  <a href="#epitome-model-api/constructor-initialize">constructor (initialize)</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/set">set</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/get">get</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/tojson">toJSON</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/unset">unset</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/empty">empty</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/destroy">destroy</a>
                </li>
              
                <li>
                  <a href="#epitome-model-api/model-properties">Model properties*</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#epitome-model-sync-api">Epitome.Model.Sync - API</a>
          
            <ul>
              
                <li>
                  <a href="#epitome-model-sync-api/constructor-initialize">constructor (initialize)</a>
                </li>
              
                <li>
                  <a href="#epitome-model-sync-api/sync">sync</a>
                </li>
              
                <li>
                  <a href="#epitome-model-sync-api/parse">parse</a>
                </li>
              
                <li>
                  <a href="#epitome-model-sync-api/save">save</a>
                </li>
              
                <li>
                  <a href="#epitome-model-sync-api/fetch">fetch</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#epitome-collection-api">Epitome.Collection - API</a>
          
            <ul>
              
                <li>
                  <a href="#epitome-collection-api/constructor-initialize">constructor (initialize)</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/addmodel">addModel</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/removemodel">removeModel</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/getmodelbycid">getModelByCID</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/getmodel">getModel</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/getmodelbyid">getModelById</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/getmodelbyid">getModelById</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/tojson">toJSON</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/empty">empty</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/sort">sort</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/reverse">reverse</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/array-helpers">Array helpers</a>
                </li>
              
                <li>
                  <a href="#epitome-collection-api/collection-properties">Collection properties*</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#epitome-storage-api">Epitome.Storage - API</a>
          
            <ul>
              
                <li>
                  <a href="#epitome-storage-api/store">store</a>
                </li>
              
                <li>
                  <a href="#epitome-storage-api/retrieve">retrieve</a>
                </li>
              
                <li>
                  <a href="#epitome-storage-api/eliminate">eliminate</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#examples">Examples</a>
          
            <ul>
              
                <li>
                  <a href="#examples/todomvc-reference">TodoMVC reference</a>
                </li>
              
            </ul>
          
        </li>
      
        <li>
          <a href="#building">Building</a>
          
        </li>
      
        <li>
          <a href="#testing">Testing</a>
          
        </li>
      
        <li>
          <a href="#development-and-contribution">Development and contribution</a>
          
        </li>
      
        <li>
          <a href="#credits-and-licensing">Credits and licensing</a>
          
        </li>
      
    </ul>
    
      <div class="extra" id="github">
        <a href="https://github.com/DimitarChristoff/Epitome">Source on Github</a>
      </div>
      
        <div class="extra" id="github-issues">
          <a href="https://github.com/DimitarChristoff/Epitome/issues">Issues</a>
        </div>
      
      
        <div id="travis" class="extra">
          <a href="http://travis-ci.org/DimitarChristoff/Epitome">
            <img src="https://secure.travis-ci.org/DimitarChristoff/Epitome.png?branch=master">
          </a>
        </div>
      
    
    
      <div class="extra twitter">
        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=D_mitar&show_count=false"></iframe>
      </div>
    
      <div class="extra twitter">
        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=policyexpert&show_count=false"></iframe>
      </div>
    
  </div>
  <div id="content">
    
      <a href="https://github.com/DimitarChristoff/Epitome" id="github-ribbon"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
    
    <p><img src="https://github.com/DimitarChristoff/Epitome/raw/master/example/epitome-logo.png" alt="Epitome">

</p>
<blockquote>
<p><em>Epitome: a typical example of a characteristic or class; embodiment; personification; model</em>

</p>
</blockquote>
<p>Epitome is an experimental MV* modular framework based upon MooTools. The building blocks of all components are extensible MooTools classes
and the Event observer patterns that come out of the box.

</p>
<p><a href="http://travis-ci.org/DimitarChristoff/Epitome"><img src="https://secure.travis-ci.org/DimitarChristoff/Epitome.png?branch=master" alt="Build Status"></a>

</p>
<p><strong>BUT, IS IT MVC?</strong>

</p>
<blockquote>
<p>&lt;jiggliemon&gt; MVD, Model View Don&#39;task

</p>
</blockquote>
<p>Strictly speaking, <code>Epitome.View</code> is closer to a MVP implementation than a classic MVC with thin logic around the views, represented by <code>Epitome.Template</code>. If you feel strongly about semantics of the patterns used, you should look at <a href="http://addyosmani.com/blog/digesting-javascript-mvc-pattern-abuse-or-evolution/">Digesting JavaScript MVC â€“ Pattern Abuse Or Evolution?</a> by Addy Osmani, a talk he gave at London Ajax recently.

</p>
<p>Epitome&#39;s API is still subject to changes, which means documentation is not overly verbose. The code itself is with a lot of inline comments added to help you understand it better.

</p>
<p>The creation and logic employed in the writing of Epitome has been documented in several blog posts:

</p>
<ul>
<li><a href="http://tech.qmetric.co.uk/creating-your-own-mvc-like-data-model-class-in-mootools_59.html">Creating the Model</a></li>
<li><a href="http://tech.qmetric.co.uk/building-a-mootools-micro-mvc-part-2-adding-sync-to-your-model_132.html">Creating the Model.Sync</a></li>
<li><a href="http://tech.qmetric.co.uk/epitome-template-a-lightweight-templating-engine-for-mootools-that-works_190.html">Adding the template</a></li>
<li><a href="http://tech.qmetric.co.uk/automating-javascript-ci-with-buster-js-and-travisci_205.html">Testing it in CI via Travis CI</a></li>
</ul>
<h2 id='epitome-model-api'>Epitome.Model - API</h2 id='epitome-model-api'>
<p>The Epitome.Model implementation at its core is a MooTools class with custom data accessors that fires events. As a MooTools Class, you can extend models or implement objects or other classes into your definitions. By default, the MooTools Options and Events classes are implemented already.

</p>
<p>The following are the officially API&#39;d class methods:

</p>
<h3 id='epitome-model-api/constructor-initialize'>constructor (initialize)</h3 id='epitome-model-api/constructor-initialize'>
<hr>
<p><em>Expects arguments: <code>(Object) model</code>, <code>(Object) options</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>ready</code></strong></em>

</p>
<p>The <code>modelObject</code> - if passed, sets the internal data hash to a new derefrenced object with the keys of the <code>modelObject</code>. Special accessor properties as defined in the <code>Epitome.Model.prototype.properties</code> will run first and be applicable. 

</p>
<p>The <code>options</code> object is a standard MooTools class options override and is being merged with the <code>Epitome.Model.prototype.options</code> when a new model is created. It typically contains various event handlers in the form of:

</p>
<pre><code class="javascript"><span class="keyword">new</span> Epitome.Model({}, {
   onChange: <span class="function"><span class="keyword">function</span><span class="params">(key, value)</span> {</span>
       console.log(key, value);
   },
   defaults: {
       userTitle: <span class="string">'admin'</span>
   }
});</code></pre>
<p>Supported: <code>(Object) options.defaults</code> - allows initial values of the model to be set if they are not being passed to the model constructor.

</p>
<p>Constructor fires an event called <code>ready</code> when done. Setting the initial model does not fire a <code>change</code> event.

</p>
<h3 id='epitome-model-api/set'>set</h3 id='epitome-model-api/set'>
<hr>
<p><em>Expects arguments: mixed: <code>(String) key</code>, <code>(Mixed) value</code> - pair - or: <code>(Object) obj</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events:</strong></em>

</p>
<ul>
<li><code>change: function(changedProperties)</code></li>
<li><code>change:key: function(valueForKey)</code></li>
</ul>
<p>Allows changing of any individual model key or a set of key/value pairs, encapsulated in an object. Will fire a single <code>change</code> event with all the changed properties as well as a specific <code>change:key</code> event that passes just the value of the key as argument.

</p>
<p>For typing of value, you can store anything at all (Primitives, Objects, Functions) but keep in mind that when it comes to serialising the Model and sending it to the server, only Primitive types make sense. 

</p>
<h3 id='epitome-model-api/get'>get</h3 id='epitome-model-api/get'>
<hr>
<p><em>Expects arguments mixed: <code>(String) key</code> or <code>(Array) keys</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p>Returns known values within the model for either a single key or an array of keys. For an array of keys, it will return an object with <code>key</code> : <code>value</code> mapping.

</p>
<h3 id='epitome-model-api/tojson'>toJSON</h3 id='epitome-model-api/tojson'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p>Returns a de-referenced Object, containing all the known model keys and values.

</p>
<h3 id='epitome-model-api/unset'>unset</h3 id='epitome-model-api/unset'>
<hr>
<p><em>Expects arguments: mixed: <code>(String) key</code> or <code>(Array) keys</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p>Removes keys from model, either a single one or an array of multiple keys. Does not fire a change event.

</p>
<h3 id='epitome-model-api/empty'>empty</h3 id='epitome-model-api/empty'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>empty</code></strong></em>

</p>
<p>Empties the model of all data and fires a single change event with all keys as well as individual <code>change:key</code> events.

</p>
<h3 id='epitome-model-api/destroy'>destroy</h3 id='epitome-model-api/destroy'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>destroy</code></strong></em>

</p>
<p>Empties the model. No change event. Event is observed by Collections the model is a member of, where it triggers a <code>removeModel()</code>


</p>
<h3 id='epitome-model-api/model-properties'>Model properties*</h3 id='epitome-model-api/model-properties'>
<p>There are several additional properties each model instance will have.

</p>
<h4>_attributes: {}</h4>
<hr>
<p>The attributes object is <strong>public</strong> (exposed to manipulation on the instance) and it holds the hash data for the model, based upon keys. It is de-referenced from the constructor object used when creating a model but should not be read directly (normally). Exported by <code>model.toJSON()</code> 

</p>
<h4>collections: []</h4>
<hr>
<p>An array that contains references to all instances of Epitome.Collection that the model is currently a member of. Useful for iteration as well as utilised by collections that want to know if Event observers are required.

</p>
<h4>options: {}</h4>
<hr>
<p>A MooTools default options set, which can be on the prototype of the Model constructor.

</p>
<h4>options.defaults: {}</h4>
<hr>
<p>An object with default Model Attributes to use when instantiating. Merged with Model object when creating. 

</p>
<h4>properties: {}</h4>
<hr>
<p>A collection of custom accessors that override default <code>model.get</code> and <code>model.set</code> methods. For example:

</p>
<pre><code class="javascript">properties: {
    foo: {
        get: <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
            <span class="comment">// scope is model</span>
            <span class="keyword">return</span> <span class="keyword">this</span>.foo();
        },
        set: <span class="function"><span class="keyword">function</span><span class="params">(value)</span> {</span>
            <span class="comment">// don't send this to the attributes, store in the instance directly.</span>
            <span class="comment">// won't fire a traditional onChange</span>
            <span class="keyword">this</span>.foo = value;
        }
    }
}</code></pre>
<p>In the example above, any calls to <code>model.set(&#39;foo&#39;, value)</code> and <code>model.get(&#39;foo&#39;)</code> are handled by custom functions. This is a pattern that allows you to use getters and setters for properties that are handled differently than normal ones. It can also be used as pre-processors for data. Make sure that you either set them on the instance directly or that you import the default ones for id in a custom prototype version as they are not merged like options.


</p>
<h2 id='epitome-model-sync-api'>Epitome.Model.Sync - API</h2 id='epitome-model-sync-api'>
<p>This is an example implementation of RESTful module that extends the base Epitome.Model class and adds the ability to read, update and delete models with remote server. In terms of implementation, there are subtle differences. The API and methods are as the normal <a href="#epitome-model-api">Model</a>, unless outlined below:

</p>
<h3 id='epitome-model-sync-api/constructor-initialize'>constructor (initialize)</h3 id='epitome-model-sync-api/constructor-initialize'>
<hr>
<p><em>Expects arguments: <code>(Object) model</code>, <code>(Object) options</code></em>

</p>
<p>A model <code>id</code> with your model as well as setup a <code>urlRoot</code> either as a property of the model or as an options property is required for your model to be synced. The constructor function first calls the Epitome.Model constructor and then sets up the XHR instance and methods.

</p>
<p>An additional option has been added <code>options.emulateREST: true || false</code>, which is being passed to the Request instance. If your server has no CRUD mapping, emulation can be enabled so everything will go through POST/GET requests with <code>_method</code> containing the original intent.

</p>
<h3 id='epitome-model-sync-api/sync'>sync</h3 id='epitome-model-sync-api/sync'>
<hr>
<p><em>Expects optional arguments: <code>(String) method</code>, <code>(Object) model</code></em>

</p>
<p><em><strong>Events: <code>sync: function(responseObj, method, options) {}</code></strong></em>

</p>
<p>Sync acts as a proxy/interface to the XHR instance in the model <code>this.request</code> A method can be one of the following:
</p>
<blockquote>
<p>get, post, create, read, delete, update

</p>
</blockquote>
<p>If no method is supplied, a <code>read</code> is performed.

</p>
<p>The second argument <code>model</code> is optional and should be a simple object. If it is not supplied, the default <code>model.toJSON()</code> is used instead.

</p>
<p>As a whole, you should NOT use the sync directly but elect to use the API methods for each specific request task.

</p>
<h3 id='epitome-model-sync-api/parse'>parse</h3 id='epitome-model-sync-api/parse'>
<hr>
<p><em>Expects arguments: <code>(Object) response</code></em>

</p>
<p><em>Expected return: <code>(Object) response</code></em>

</p>
<p>A method that you can extend in your definition of Models for doing any pre-processing of data returned by sync from the server. For example:

</p>
<pre><code class="javascript">parse: <span class="function"><span class="keyword">function</span><span class="params">(response)</span> {</span>
    <span class="comment">// data comes back with decoration. split them first.</span>
    <span class="keyword">this</span>.meta = response.meta;
    <span class="keyword">return</span> response.data;
}</code></pre>
<h3 id='epitome-model-sync-api/save'>save</h3 id='epitome-model-sync-api/save'>
<hr>
<p><em>Expects optional arguments: <code>(String) key</code>, <code>(String) value</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>save</code>, <code>sync</code>, possibly <code>create</code>, <code>update</code></strong></em>

</p>
<p>The save should send the contents of the model to the server for storage. If it is a model that has not been saved before or fetched from the server, it will do so via <code>create()</code>, else, it will use <code>update()</code> instead.

</p>
<p>If the optional <code>key</code> =&gt; <code>value</code> pair is passed, it will set them on the model and then save the updated model.

</p>
<h3 id='epitome-model-sync-api/fetch'>fetch</h3 id='epitome-model-sync-api/fetch'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>fetch</code>, <code>sync</code>, <code>read</code></strong></em>

</p>
<p>It will request the server to return the model object for the current id via a <code>.read()</code>. It will also change the status of the model (<code>model.isNewModel</code>) to false, meaning <code>.save()</code> will never use <code>.create()</code>. The fetch event will fire once the response object has been returned. The response object is then merged with the current model via a <code>.set</code>, it won&#39;t empty your data. To do so, you need to issue a <code>.empty()</code> first.

</p>
<h2 id='epitome-collection-api'>Epitome.Collection - API</h2 id='epitome-collection-api'>
<p>Epitome collections are in essence, an Array-like Class that can contain multiple Models. It has a basic model prototype and adding and removing of models works either based upon passing a simple data has or an actual Model instance. When a model is in a collection, it observes all of the model events and fires them on the collection instance. It also allows for filtering, mapping, sorting and many other more convenience methods.

</p>
<h3 id='epitome-collection-api/constructor-initialize'>constructor (initialize)</h3 id='epitome-collection-api/constructor-initialize'>
<hr>
<p><em>Expects arguments: <code>(Array) models / objects</code> (or a single model /object), <code>(Object) options</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>ready</code></strong></em>

</p>
<p>The constructor method will accept a large variety of arguments. You can pass on either an Array of Models or an Array of Objects or a single Model or a single Object. You can also pass an empty Array and populate it later. Typical Collection prototype definition looks something like this:
</p>
<pre><code>var usersCollection = <span class="keyword">new</span> <span class="keyword">Class</span>({
    Extends: Epitome.Collection
    model: userModel // <span class="keyword">or</span> Epitome.Model by <span class="keyword">default</span>
});

var users = <span class="keyword">new</span> usersCollection([{
    id: <span class="comment">'bob'</span>
}], {
    onChange: <span class="keyword">function</span>(model, props) {
        console.<span class="built_in">log</span>(<span class="comment">'model change', model, props);</span>
    },
    onReady: <span class="keyword">function</span>() {
        console.<span class="built_in">log</span>(<span class="comment">'the collection is ready');</span>
    }
});</code></pre>
<p>For reference purposes, each Model that enters a collection needs to have a <code>cid</code> - collection id. If the Model has an <code>id</code>, that is preferred. Otherwise, a <code>cid</code> will be generated. If the Model gets an <code>id</code> later on, the <code>cid</code> will not be changed.

</p>
<h3 id='epitome-collection-api/addmodel'>addModel</h3 id='epitome-collection-api/addmodel'>
<hr>
<p><em>Expects arguments: <code>(Mixed) model</code> , <code>(Boolean) replace</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>add: function(model, cid) {}</code></strong></em>

</p>
<p>Adding a Model to a Collection must always happen through this method. It either appends the Model instance to the internal <code>_models</code> Array or it creates a new Model and then appends it. It also starts observing the Model&#39;s events and emitting them to the Collection instance with an additional argument passed <code>Model</code>. So, if you add a Model stored in <code>bob</code> and then do <code>bob.fireEvent(&#39;hai&#39;, &#39;there&#39;)</code>, the collection will also fire an event like this: <code>this.fireEvent(&#39;hai&#39;, [bob, &#39;there&#39;]); Adding a Model also increases the </code>Collection.length` property.

</p>
<p>The monitoring of the events (Observer) is done through creating a local function override / decoration of the Model&#39;s <code>fireEvent</code> method, normally inherited from the MooTools Events Class. If a model stops being a part of a collection, the override is destroyed and the default <code>fireEvent</code>.

</p>
<h3 id='epitome-collection-api/removemodel'>removeModel</h3 id='epitome-collection-api/removemodel'>
<hr>
<p><em>Expects arguments: <code>(Mixed) model(s)</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>remove: function(model, cid) {}</code>, <code>reset</code></strong></em>

</p>
<p>This method allows you to remove a single model or an array of models from the collection in the same call. For each removed model, a <code>remove</code> Event will fire. When removing of all Models is done, the collection will also fire a <code>reset</code> event, allowing you to re-render your views if you like.

</p>
<p>In addition to removing the Model from the Collection, it removes the reference to the Collection in the Model&#39;s <code>collections</code> Array. If that model stops being a member of any collection, the observed <code>fireEvent</code> method is removed from the Model instance, resulting in the method from the Events Class prototype taking over.

</p>
<p>Decreases the <code>Collection.length</code> property.

</p>
<h3 id='epitome-collection-api/getmodelbycid'>getModelByCID</h3 id='epitome-collection-api/getmodelbycid'>
<hr>
<p><em>Expects arguments: <code>(String) cid</code></em>

</p>
<p><em>Returns: <code>modelInstance</code> or <code>null</code></em>

</p>
<p>Performs a search in the collection by <code>cid</code> (Collection id). Returns found Model instance or <code>null</code> if no match is found.

</p>
<h3 id='epitome-collection-api/getmodel'>getModel</h3 id='epitome-collection-api/getmodel'>
<hr>
<p><em>Expects arguments: <code>(Number) id</code></em>

</p>
<p><em>Returns: <code>modelInstance</code> or <code>null</code></em>

</p>
<p>Returns a model based upon the Array index in the Collection.

</p>
<h3 id='epitome-collection-api/getmodelbyid'>getModelById</h3 id='epitome-collection-api/getmodelbyid'>
<hr>
<p><em>Expects arguments: <code>(String) id</code></em>

</p>
<p><em>Returns: <code>modelInstance</code> or <code>null</code></em>

</p>
<p>Performs a search in the collection by the Model&#39;s <code>id</code> via the standard <code>getter</code>. Returns found Model instance or <code>null</code> if no match is found.

</p>
<h3 id='epitome-collection-api/getmodelbyid'>getModelById</h3 id='epitome-collection-api/getmodelbyid'>
<hr>
<p><em>Expects arguments: <code>(String) id</code></em>

</p>
<p><em>Returns: <code>modelInstance</code> or <code>null</code></em>

</p>
<p>Performs a search in the collection by the Model&#39;s <code>id</code> via the standard <code>getter</code>. Returns found Model instance or <code>null</code> if no match is found.

</p>
<h3 id='epitome-collection-api/tojson'>toJSON</h3 id='epitome-collection-api/tojson'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>modelsData</code></em>

</p>
<p>Returns an array of the applied <code>toJSON</code> method on all Models in the collection.

</p>
<h3 id='epitome-collection-api/empty'>empty</h3 id='epitome-collection-api/empty'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>remove</code>, <code>reset</code>, <code>empty</code></strong></em>

</p>
<p>Applies <code>this.removeModel</code> to all Models of the collection. Fires <code>empty</code> when done - though before that, a <code>remove</code> and <code>reset</code> will fire, see <a href="#epitome-collection-api/removemodel">removeModel</a>

</p>
<h3 id='epitome-collection-api/sort'>sort</h3 id='epitome-collection-api/sort'>
<hr>
<p><em>Expects arguments: (Mixed) how</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>sort</code></strong></em>

</p>
<p>Sorting is quite flexible. It works a lot like <code>Array.prototype.sort</code>. By default, you can sort based upon strings that represent keys in the Models. For example:
</p>
<pre><code><span class="identifier">users</span>.<span class="identifier"><span class="keymethods">sort</span></span>(<span class="string">'name'</span>);
<span class="regexp">//</span> <span class="identifier">descending</span> <span class="identifier">order</span> <span class="identifier">pseduo</span>
<span class="identifier">users</span>.<span class="identifier"><span class="keymethods">sort</span></span>(<span class="string">'name:desc'</span>);</code></pre>
<p>Sorting also allows you to pass a function you define yourself as per the <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort">Array.prototype.sort</a> interface. When done, it will fire a <code>sort</code> event.

</p>
<h3 id='epitome-collection-api/reverse'>reverse</h3 id='epitome-collection-api/reverse'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>sort</code></strong></em>

</p>
<p>Reverses sort the order of Models in the collection. Fires a <code>sort</code> event, not <code>reverse</code>

</p>
<h3 id='epitome-collection-api/array-helpers'>Array helpers</h3 id='epitome-collection-api/array-helpers'>
<p>The following Array methods are also available directly on the Collection instances:

</p>
<ul>
<li>forEach</li>
<li>each</li>
<li>invoke</li>
<li>filter</li>
<li>map</li>
<li>some</li>
<li>indexOf</li>
<li>contains</li>
<li>getRandom</li>
<li>getLast</li>
</ul>
<p>For more information, see <a href="http://mootools.net/docs/core/Types/Array">Mootools Array Type</a>

</p>
<h3 id='epitome-collection-api/collection-properties'>Collection properties*</h3 id='epitome-collection-api/collection-properties'>
<h4>_models</h4>
<hr>
<p>Each Collection instance has an Array property called <code>_models</code> that contains all referenced Model instances. Even though it is not a real private property, it is recommended you do not alter it from outside of the API.

</p>
<h4>length</h4>
<hr>
<p>Tries to always reference the length of <code>_models</code>.

</p>
<h4>model</h4>
<hr>
<p>Each Collection prototype has that property that references a Model prototype constructor. When data is being received in raw format (so, simple Objects), Models are being created by instantiating the stored constructor object in <code>this.model</code>.

</p>
<h2 id='epitome-storage-api'>Epitome.Storage - API</h2 id='epitome-storage-api'>
<p>The storage Class is meant to be used as a mix-in. It works with any instances of Epitome.Model (including Epitome.Model.Sync) as well as Epitome.Collection.

</p>
<p>To add storage functionality to your model, you declare use in the prototype via the <code>Implements</code> mutator:
</p>
<pre><code><span class="keyword">var</span> user = <span class="keyword">new</span> <span class="keyword">Class</span>({
    <span class="keyword">Extends</span>: Epitome.Model,
    <span class="keyword">Implements</span>: Epitome.Storage.localStorage(<span class="string">'model'</span>)
});</code></pre>
<p>The code above will call the storage factory and enable <code>localStorage</code> within your model with a storage namespace key <code>model</code>. In the actual storage massive, data will appear under an <code>epitome-model</code> key.

</p>
<p>The following methods are added to your Class (identical to Element.Storage from MooTools):

</p>
<h3 id='epitome-storage-api/store'>store</h3 id='epitome-storage-api/store'>
<hr>
<p><em>Expects optional arguments: <code>(Object) model</code></em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>store: function(model) {}</code></strong></em>

</p>
<p>When called without any arguments, store will just save the current model or collection into storage. The models and collections are stored under a sub-key of the value returned <code>.get(&#39;id&#39;)</code>, so it is important to have an id in both if you want to achieve persistence.

</p>
<p><strong>If no id is provided, an id is generated for models and collections, which means a page reload will cause a different id to be generated and no data will be retrieved</strong>

</p>
<p>You can also pass a custom object as argument to write instead of the current model or collection.

</p>
<h3 id='epitome-storage-api/retrieve'>retrieve</h3 id='epitome-storage-api/retrieve'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>(Object) model</code> or <code>(Array) collection</code></em>

</p>
<p><em><strong>Events: <code>retrieve: function(model) {}</code></strong></em>

</p>
<p>When you retrieve a model or a collection, it will simply return what the browser has as data (based upon the model or colleciton id as key). It will <strong>NOT</strong> apply a <code>model.set(data)</code> for you, you need to do this yourself.
</p>
<pre><code><span class="keyword">var</span> bob = <span class="keyword">new</span> user({
    id: <span class="string">'bob'</span>
});

<span class="comment">// populate model from storage, if available.</span>
bob.<span class="keyword">set</span>(bob.retrieve());</code></pre>
<p>Automatically populate:
</p>
<pre><code><span class="keyword">var</span> bob = <span class="keyword">new</span> user({
    id: <span class="string">'bob'</span>
}, {
    onRetrieve: <span class="function"><span class="keyword">function</span><span class="params">(data)</span> {</span>
        <span class="keyword">this</span>.set(data);
    }
}).retrieve();</code></pre>
<h3 id='epitome-storage-api/eliminate'>eliminate</h3 id='epitome-storage-api/eliminate'>
<hr>
<p><em>Expects arguments: none</em>

</p>
<p><em>Returns: <code>this</code></em>

</p>
<p><em><strong>Events: <code>eliminate</code></strong></em>

</p>
<p>Calling eliminate on a model or a collection will destroy the stored data the browser has for that model or collection.

</p>
<h2 id='examples'>Examples</h2 id='examples'>
<hr>
<p>A quick model creation with prototyping and <code>localStorage</code> looks like this:

</p>
<pre><code class="javascript"><span class="comment">// create a new user class prototype, basing it on Epitome.Model.Sync and implement storage</span>
<span class="keyword">var</span> User = <span class="keyword">new</span> Class({
    Extends: Epitome.Model.Sync,
    Implements: Epitome.Storage.sessionStorage(),
    options: {
        defaults: {
            urlRoot: <span class="string">'/user'</span>
        }
    }
});

<span class="comment">// make a new model with id '1' and a property 'name'</span>
<span class="keyword">var</span> userModel = <span class="keyword">new</span> User({
    id: <span class="string">'1'</span>,
    name: <span class="string">'Bobby'</span>
}, {
    <span class="comment">// default model values to instance only.</span>
    defaults: {
        surname: <span class="string">'Robertson'</span>
    },
    <span class="comment">// add some events</span>
    onChange: <span class="function"><span class="keyword">function</span><span class="params">(key, value)</span> {</span>
        console.log(<span class="string">'you changed '</span> + key + <span class="string">' to '</span> + value);
    },
    onSave: <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="comment">// also save to localStorage</span>
        <span class="keyword">this</span>.store();
    },
    <span class="string">"onChange:name"</span>: <span class="function"><span class="keyword">function</span><span class="params">(value)</span> {</span>
        console.log(<span class="string">'you changed your name to '</span> + value);
    }
}); <span class="comment">// attr: name: 'Bobby', id: 1, surname: 'Robertson', userModel.urlRoot = '/user/'</span>

<span class="comment">// change some values.</span>
userModel.set({
    surname: <span class="string">'Roberts'</span>,
    name: <span class="string">'Bob'</span>
});


<span class="comment">// get from storage if available, else - from server</span>
<span class="keyword">var</span> data = userModel.retrieve();
<span class="keyword">if</span> (data) {
    userModel.set(data);
}
<span class="keyword">else</span> {
    userModel.read();
}

<span class="comment">// go wild!</span>
userModel.save();</code></pre>
<p>For more examples, have a look inside of <code>example/js/</code>

</p>
<h3 id='examples/todomvc-reference'>TodoMVC reference</h3 id='examples/todomvc-reference'>
<hr>
<p>A standard <a href="http://todomvc.com/">TodoMVC</a> reference implementation has been provided here: <a href="https://github.com/DimitarChristoff/Epitome-todo">Epitome-todo</a>.

</p>
<p>You can view it in action here:
<a href="http://fragged.org/Epitome/example/todo/epitome/#!/"><a href="http://fragged.org/Epitome/example/todo/epitome/#!/">http://fragged.org/Epitome/example/todo/epitome/#!/</a></a>

</p>
<p>The todo app is also a submodule of Epitome so you can add it by doing this at the root of the repo:
</p>
<pre><code><span class="title">git</span> submodule init
<span class="title">git</span> submodule update</code></pre>
<p>And you can keep it updated by going to <code>~/example/todo/</code> and doing a pull


</p>
<h2 id='building'>Building</h2 id='building'>
<hr>
<p>You can create a minified concatenated version of Epitome. Have a look inside of the simple <code>app.build.js</code> you can use for <code>r.js</code> (require.js optimiser).

</p>
<p>Typically, you&#39;d create a new production build by running:

</p>
<pre><code>> r<span class="preprocessor">.js</span> -o app<span class="preprocessor">.build</span><span class="preprocessor">.js</span>

Tracing dependencies for: epitome
Uglifying file: /projects/Epitome/Epitome-min<span class="preprocessor">.js</span>

/projects/Epitome/Epitome-min<span class="preprocessor">.js</span>
----------------
/projects/Epitome/src/epitome<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-isequal<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-model<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-model-sync<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-storage<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-collection<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-collection-sync<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-template<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-view<span class="preprocessor">.js</span>
/projects/Epitome/src/epitome-router<span class="preprocessor">.js</span></code></pre>
<p>Install requirejs via npm, if you haven&#39;t:

</p>
<pre><code><span class="title">npm</span> install -g requirejs</code></pre>
<p>Alternatively, grab r.js and put it inside the project, then do <code>node r.js -o app.build.js</code>

</p>
<p>An npm package is also available:

</p>
<pre><code><span class="title">npm</span> install epitome</code></pre>
<h2 id='testing'>Testing</h2 id='testing'>
<hr>
<p>Tests are currently separated in 2 groups: node tests and browser tests. The distinction is that under node only,
it uses <code>mootools-server</code> and lacks <code>Request</code> or <code>Element</code>, so only unit tests will run.

</p>
<p>Testing is run via <a href="http://busterjs.org">Buster.js</a> can be found in <code>/tests/</code> - check the README.md there for more info.

</p>
<p><em>Please note that as of buster 0.6.0, having browser and node test groups at the same time fails to terminate the buster-test process. node tests are temporary disabled</em>


</p>
<h2 id='development-and-contribution'>Development and contribution</h2 id='development-and-contribution'>
<hr>
<p>Feel free to fork, play and contribute back to the project if you can, pull requests are more than welcome. Just make sure you
create the request in a branch and write tests / fix existing tests before you send it. Oh, and make sure it does not break the build!

</p>
<h2 id='credits-and-licensing'>Credits and licensing</h2 id='credits-and-licensing'>
<hr>
<p>Built by QMetric Group Limited.

</p>
<p>Concept and development by <a href="http://twitter.com/D_mitar">Dimitar Christoff</a>

</p>
<p><img src="http://tech.qmetric.co.uk/wp-content/themes/the-bootstrap/images/qmetric-logo-on.png" alt="QMetric">

</p>
<p>Released under the MIT license <a href="http://mootools.net/license.txt"><a href="http://mootools.net/license.txt">http://mootools.net/license.txt</a></a></p>

  </div>
</div></body>
</html>